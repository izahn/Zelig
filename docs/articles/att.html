<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Average Treatment Effects on the Treated (ATT) • Zelig</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Zelig Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/quickstart.html">Quickstart</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/index.html#section-zelig-overview">Zelig Overview</a>
    </li>
    <li>
      <a href="../articles/index.html#section-core-zelig-model-details">Zelig Model Details</a>
    </li>
    <li>
      <a href="../articles/index.html#section-other">Other</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Function Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../reference/index.html#section-main-zelig-workflow">Workflow</a>
    </li>
    <li>
      <a href="../reference/index.html#section-estimation-methods">Estimation Methods</a>
    </li>
    <li>
      <a href="../reference/index.html#section-exterior-interaction-functions">Interacting Outside of Zelig</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/about.html">Contact/Development Team/Citation</a>
    </li>
    <li>
      <a href="../articles/roadmap.html">Development Roadmap</a>
    </li>
    <li>
      <a href="https://iqss.github.io/rpackagemetrics/">Zelig Adoption Metrics</a>
    </li>
    <li>
      <a href="https://raw.githubusercontent.com/IQSS/Zelig/master/.iqss_reportcard.yml">Statistical Software Devepment Reportcard</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://medium.com/zelig-dev/archive">
    <span class="fa fa-medium"></span>
     
    Dev-Blog
  </a>
</li>
<li>
  <a href="https://twitter.com/zeligproject">
    <span class="fa fa-twitter fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/IQSS/Zelig">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Average Treatment Effects on the Treated (ATT)</h1>
            
            <h4 class="date">2017-11-03</h4>
          </div>

    
    
<div class="contents">
<p><em>Built using Zelig version 5.1.4</em></p>
<hr>
<div id="average-treatment-effects-on-the-treated" class="section level2">
<h2 class="hasAnchor">
<a href="#average-treatment-effects-on-the-treated" class="anchor"></a>Average Treatment Effects on the Treated</h2>
<p>Sometimes the quantity of interest you are interested in is the average effect of some treatment on the group of individuals that received treatment (as opposed to, for example, the effect of the treatment averaged across all individuals in a study regardless of whether or not they received the treatment).</p>
<p>The tools available in R for calculating treatment effects leave a lot to be desired. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)

<span class="co"># load data and estimate model</span>
<span class="kw">data</span>(sanction, <span class="dt">package =</span> <span class="st">"Zelig"</span>)

m &lt;-<span class="st"> </span><span class="kw">glm</span>(num <span class="op">~</span><span class="st"> </span>target <span class="op">+</span><span class="st"> </span>coop <span class="op">+</span><span class="st"> </span>mil, <span class="dt">family =</span> <span class="st">"poisson"</span>, <span class="dt">data =</span> sanction)

treated &lt;-<span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(sanction, mil <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)
treated &lt;-<span class="st"> </span><span class="kw">rbind</span>(treated, <span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(treated, <span class="dt">mil =</span> <span class="dv">0</span>))

pred &lt;-<span class="st"> </span><span class="kw">data.frame</span>(treated,
                   <span class="kw">predict</span>(m,
                           <span class="dt">newdata =</span> treated,
                           <span class="dt">type =</span> <span class="st">"response"</span>,
                           <span class="dt">se =</span> <span class="ot">TRUE</span>))
<span class="kw"><a href="http://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(pred, mil), <span class="dt">fitted =</span> <span class="kw">mean</span>(fit), <span class="dt">se =</span> <span class="kw">mean</span>(se.fit))</code></pre></div>
<pre><code>## # A tibble: 2 x 3
##     mil   fitted        se
##   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1     0 13.55551 0.9862148
## 2     1  6.50000 0.9750880</code></pre>
<p>Alternatively:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(margins)

pred &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/margins/topics/reexports">prediction</a></span>(m, <span class="dt">data =</span> <span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(sanction, mil <span class="op">==</span><span class="st"> </span><span class="dv">1</span>), <span class="dt">at =</span> <span class="kw">list</span>(<span class="dt">mil =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</code></pre></div>
<pre><code>## Warning in check_values(data, at): A 'at' value for 'mil' is outside
## observed data range (1,1)!</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(pred, mil), <span class="dt">fitted =</span> <span class="kw">mean</span>(fitted), <span class="dt">se =</span> <span class="kw">mean</span>(se.fitted))</code></pre></div>
<pre><code>## # A tibble: 2 x 3
##     mil   fitted        se
##   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1     0 13.55551 0.9862148
## 2     1  6.50000 0.9750880</code></pre>
<p>In this example the treatment variable was <code>mil</code>. Units were denoted as treated when <code>mil = 1</code>. Background ==========</p>
<p>Assume there is a set of treatments <span class="math inline">\(\mathbb{T} \in \{0,1\}\)</span>, e.g. in the example above: <code>mil = 0</code> and <code>mil = 1</code>. For each unit <span class="math inline">\(i\)</span> there are corresponding potential outcomes <span class="math inline">\(Y_i(0)\)</span> and <span class="math inline">\(Y_i(1)\)</span>, with unit-level casual effects of the treatment typically being: <span class="math inline">\(Y_i(1) - Y_i(0)\)</span>. The unit-level causal effect is the difference between the outcome from being exposed to the treatment and not being exposed.</p>
<p>We can think of the average causal effect across the entire population as:</p>
<p><span class="math display">\[
    \tau_{fs} = \frac{1}{N} \sum_{i=1}^N(Y_i(1) - Y_i(0))
\]</span></p>
<p>where <span class="math inline">\(fs\)</span> denotes a finite sample and <span class="math inline">\(N\)</span> is the number of units in the sample.</p>
<p>We may be particularly interested in the effect of the treatment on units that were exposed to the treatment (<span class="math inline">\(i:W_i = 1\)</span>)–the ATT. The ATT is given by:</p>
<p><span class="math display">\[
    \tau_{fs,t} = \frac{1}{N_t} \sum_{i:W_i=1}^N(Y_i(1) - Y_i(0))
\]</span></p>
<p>where <span class="math inline">\(N_t\)</span> is the number of units actively exposed to the treatment.</p>
</div>
<div id="see-also" class="section level1">
<h1 class="hasAnchor">
<a href="#see-also" class="anchor"></a>See Also</h1>
<p>Imbens, Guido W. and Donald B. Rubin. 2015. Causal inference for Statistics, Social and Biomedical Science. Cambridge: Cambridge University Press.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#average-treatment-effects-on-the-treated">Average Treatment Effects on the Treated</a></li>
      <li><a href="#see-also">See Also</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, Olivia Lau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
